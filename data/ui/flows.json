[
    {
        "id": "9e95f962de164512",
        "type": "tab",
        "label": "dump1090",
        "disabled": false,
        "info": "",
        "env": []
    },
    {
        "id": "a434980c0d70073f",
        "type": "tab",
        "label": "map",
        "disabled": false,
        "info": "",
        "env": []
    },
    {
        "id": "9484dc2f12c3f5c6",
        "type": "tab",
        "label": "map buttons",
        "disabled": false,
        "info": "",
        "env": []
    },
    {
        "id": "eeaa68697bf28d0e",
        "type": "tab",
        "label": "dashboard",
        "disabled": false,
        "info": "",
        "env": []
    },
    {
        "id": "65a0877e913c9221",
        "type": "ui_tab",
        "name": "Plane Spotter",
        "icon": "dashboard",
        "disabled": false,
        "hidden": true
    },
    {
        "id": "5c701558e935be96",
        "type": "ui_base",
        "theme": {
            "name": "theme-dark",
            "lightTheme": {
                "default": "#0094CE",
                "baseColor": "#0094CE",
                "baseFont": "-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif",
                "edited": true,
                "reset": false
            },
            "darkTheme": {
                "default": "#097479",
                "baseColor": "#408080",
                "baseFont": "-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif",
                "edited": true,
                "reset": false
            },
            "customTheme": {
                "name": "Untitled Theme 1",
                "default": "#4B7930",
                "baseColor": "#4B7930",
                "baseFont": "-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif"
            },
            "themeState": {
                "base-color": {
                    "default": "#097479",
                    "value": "#408080",
                    "edited": true
                },
                "page-titlebar-backgroundColor": {
                    "value": "#408080",
                    "edited": false
                },
                "page-backgroundColor": {
                    "value": "#111111",
                    "edited": false
                },
                "page-sidebar-backgroundColor": {
                    "value": "#ffffff",
                    "edited": false
                },
                "group-textColor": {
                    "value": "#5eaeae",
                    "edited": false
                },
                "group-borderColor": {
                    "value": "#555555",
                    "edited": false
                },
                "group-backgroundColor": {
                    "value": "#333333",
                    "edited": false
                },
                "widget-textColor": {
                    "value": "#eeeeee",
                    "edited": false
                },
                "widget-backgroundColor": {
                    "value": "#408080",
                    "edited": false
                },
                "widget-borderColor": {
                    "value": "#333333",
                    "edited": false
                },
                "base-font": {
                    "value": "-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif"
                }
            },
            "angularTheme": {
                "primary": "indigo",
                "accents": "blue",
                "warn": "red",
                "background": "grey",
                "palette": "light"
            }
        },
        "site": {
            "name": "Plane Spotter",
            "hideToolbar": "false",
            "allowSwipe": "false",
            "lockMenu": "false",
            "allowTempTheme": "true",
            "dateFormat": "DD/MM/YYYY",
            "sizes": {
                "sx": 48,
                "sy": 48,
                "gx": 6,
                "gy": 6,
                "cx": 6,
                "cy": 6,
                "px": 0,
                "py": 0
            }
        }
    },
    {
        "id": "8363fd07a79e8b50",
        "type": "ui_group",
        "name": "Map",
        "tab": "65a0877e913c9221",
        "order": 1,
        "disp": false,
        "width": "20",
        "collapse": false,
        "className": ""
    },
    {
        "id": "350b84a00a67874f",
        "type": "ui_group",
        "name": "Aircraft",
        "tab": "65a0877e913c9221",
        "order": 2,
        "disp": true,
        "width": 8,
        "collapse": false,
        "className": ""
    },
    {
        "id": "2a53099271750475",
        "type": "ui_group",
        "name": "Aircraft Detail",
        "tab": "65a0877e913c9221",
        "order": 3,
        "disp": true,
        "width": "8",
        "collapse": false,
        "className": ""
    },
    {
        "id": "5d571e7886c72a5e",
        "type": "ui_group",
        "name": "Station",
        "tab": "65a0877e913c9221",
        "order": 4,
        "disp": true,
        "width": "6",
        "collapse": false,
        "className": ""
    },
    {
        "id": "31a31f3d8ad6e101",
        "type": "ui_spacer",
        "z": "a434980c0d70073f",
        "name": "spacer",
        "group": "5d571e7886c72a5e",
        "order": 11,
        "width": 2,
        "height": 1
    },
    {
        "id": "c8c37713f6d3bdbb",
        "type": "file in",
        "z": "9e95f962de164512",
        "name": "",
        "filename": "payload",
        "filenameType": "msg",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 300,
        "y": 80,
        "wires": [
            [
                "bde103ae399da555"
            ]
        ]
    },
    {
        "id": "bde103ae399da555",
        "type": "json",
        "z": "9e95f962de164512",
        "name": "",
        "property": "payload",
        "action": "obj",
        "pretty": false,
        "x": 310,
        "y": 140,
        "wires": [
            [
                "7f3c6f83cc47b9f3"
            ]
        ]
    },
    {
        "id": "7f3c6f83cc47b9f3",
        "type": "change",
        "z": "9e95f962de164512",
        "name": "basename -> topic",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "$split(file, \".\")[0]\t",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 270,
        "y": 200,
        "wires": [
            [
                "971b764e2dc64f2f"
            ]
        ]
    },
    {
        "id": "971b764e2dc64f2f",
        "type": "switch",
        "z": "9e95f962de164512",
        "name": "",
        "property": "topic",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "receiver",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "stats",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "aircraft",
                "vt": "str"
            }
        ],
        "checkall": "false",
        "repair": false,
        "outputs": 3,
        "x": 530,
        "y": 80,
        "wires": [
            [
                "805de6d09119fce1"
            ],
            [
                "3aa8cd7ef5bedf96"
            ],
            [
                "07477b5e52ba360d"
            ]
        ]
    },
    {
        "id": "3aa8cd7ef5bedf96",
        "type": "link out",
        "z": "9e95f962de164512",
        "name": "stats json",
        "mode": "link",
        "links": [
            "87ae45c3d541df2a"
        ],
        "x": 685,
        "y": 80,
        "wires": []
    },
    {
        "id": "805de6d09119fce1",
        "type": "link out",
        "z": "9e95f962de164512",
        "name": "receiver json",
        "mode": "link",
        "links": [
            "beebb160cf9b6f36",
            "7c0fa2ce358e8e0e",
            "807abd24f5885cc3",
            "0475633569aff1cb"
        ],
        "x": 685,
        "y": 40,
        "wires": []
    },
    {
        "id": "07477b5e52ba360d",
        "type": "change",
        "z": "9e95f962de164512",
        "name": "-> payload",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.aircraft",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 530,
        "y": 200,
        "wires": [
            [
                "24a4224a09280ab5",
                "8cdf09e540f54f76"
            ]
        ]
    },
    {
        "id": "24a4224a09280ab5",
        "type": "split",
        "z": "9e95f962de164512",
        "name": "",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 710,
        "y": 220,
        "wires": [
            [
                "6a927a31926136b4"
            ]
        ]
    },
    {
        "id": "6a927a31926136b4",
        "type": "link out",
        "z": "9e95f962de164512",
        "name": "aircraft records",
        "mode": "link",
        "links": [
            "4404caecbde969ef"
        ],
        "x": 835,
        "y": 220,
        "wires": []
    },
    {
        "id": "6ec40af1917d9ff4",
        "type": "link out",
        "z": "9e95f962de164512",
        "name": "aircraft table",
        "mode": "link",
        "links": [
            "1f9a326e881f765b"
        ],
        "x": 835,
        "y": 180,
        "wires": []
    },
    {
        "id": "8cdf09e540f54f76",
        "type": "change",
        "z": "9e95f962de164512",
        "name": "aircraft db",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "aircraft-all",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 700,
        "y": 180,
        "wires": [
            [
                "6ec40af1917d9ff4"
            ]
        ]
    },
    {
        "id": "d10d82c850a158f4",
        "type": "watch",
        "z": "9e95f962de164512",
        "name": "aircraft.json",
        "files": "/data/tmp/aircraft.json",
        "recursive": "",
        "x": 110,
        "y": 40,
        "wires": [
            [
                "c8c37713f6d3bdbb"
            ]
        ]
    },
    {
        "id": "7d6afe9bdfbef990",
        "type": "watch",
        "z": "9e95f962de164512",
        "name": "stats.json",
        "files": "/data/tmp/stats.json",
        "recursive": "",
        "x": 120,
        "y": 80,
        "wires": [
            [
                "c8c37713f6d3bdbb"
            ]
        ]
    },
    {
        "id": "a61ef5a38f39aa2a",
        "type": "watch",
        "z": "9e95f962de164512",
        "name": "receiver.json",
        "files": "/data/tmp/receiver.json",
        "recursive": "",
        "x": 110,
        "y": 120,
        "wires": [
            [
                "c8c37713f6d3bdbb"
            ]
        ]
    },
    {
        "id": "4404caecbde969ef",
        "type": "link in",
        "z": "a434980c0d70073f",
        "name": "link in 1",
        "links": [
            "6a927a31926136b4"
        ],
        "x": 115,
        "y": 60,
        "wires": [
            [
                "b54a18c9b35f8e47"
            ]
        ]
    },
    {
        "id": "03565d1e34e0f066",
        "type": "change",
        "z": "a434980c0d70073f",
        "name": "prepare for mapping",
        "rules": [
            {
                "t": "set",
                "p": "payload.name",
                "pt": "msg",
                "to": "payload.hex",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "payload.icon",
                "pt": "msg",
                "to": "plane",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "payload.layer",
                "pt": "msg",
                "to": "aircraft",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "payload.speed",
                "pt": "msg",
                "to": "payload.gs * 0.5144",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 160,
        "y": 220,
        "wires": [
            [
                "d1bf963c0af13232"
            ]
        ]
    },
    {
        "id": "d1bf963c0af13232",
        "type": "switch",
        "z": "a434980c0d70073f",
        "name": "has callsign?",
        "property": "payload.flight",
        "propertyType": "msg",
        "rules": [
            {
                "t": "nempty"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 450,
        "y": 100,
        "wires": [
            [
                "bc502453312cb200"
            ],
            [
                "a7ed90fe34deafbd"
            ]
        ]
    },
    {
        "id": "bc502453312cb200",
        "type": "change",
        "z": "a434980c0d70073f",
        "name": "callsign -> label",
        "rules": [
            {
                "t": "set",
                "p": "payload.label",
                "pt": "msg",
                "to": "payload.flight",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "payload.iconColor",
                "pt": "msg",
                "to": "blue",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 680,
        "y": 80,
        "wires": [
            [
                "472f03a94276dd04"
            ]
        ]
    },
    {
        "id": "a7ed90fe34deafbd",
        "type": "change",
        "z": "a434980c0d70073f",
        "name": "name -> label",
        "rules": [
            {
                "t": "set",
                "p": "payload.label",
                "pt": "msg",
                "to": "$uppercase(payload.hex)",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "payload.icon",
                "pt": "msg",
                "to": "arrow",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "payload.iconColor",
                "pt": "msg",
                "to": "slateblue",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 560,
        "y": 220,
        "wires": [
            [
                "19e42b65ee2aa91e"
            ]
        ]
    },
    {
        "id": "472f03a94276dd04",
        "type": "switch",
        "z": "a434980c0d70073f",
        "name": "is small craft?",
        "property": "payload.flight",
        "propertyType": "msg",
        "rules": [
            {
                "t": "regex",
                "v": "^N",
                "vt": "str",
                "case": false
            },
            {
                "t": "else"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 680,
        "y": 160,
        "wires": [
            [
                "c5e3bc18fe33db62"
            ],
            [
                "19e42b65ee2aa91e"
            ]
        ]
    },
    {
        "id": "c5e3bc18fe33db62",
        "type": "change",
        "z": "a434980c0d70073f",
        "name": "small craft icon",
        "rules": [
            {
                "t": "set",
                "p": "payload.icon",
                "pt": "msg",
                "to": "smallplane",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 900,
        "y": 140,
        "wires": [
            [
                "19e42b65ee2aa91e"
            ]
        ]
    },
    {
        "id": "19e42b65ee2aa91e",
        "type": "ui_worldmap",
        "z": "a434980c0d70073f",
        "group": "8363fd07a79e8b50",
        "order": 1,
        "width": 20,
        "height": 14,
        "name": "",
        "lat": "",
        "lon": "",
        "zoom": "8",
        "layer": "OSMC",
        "cluster": "7",
        "maxage": "60",
        "usermenu": "show",
        "layers": "show",
        "panit": "false",
        "panlock": "false",
        "zoomlock": "false",
        "hiderightclick": "true",
        "coords": "deg",
        "showgrid": "false",
        "showruler": "false",
        "allowFileDrop": "false",
        "path": "/worldmap",
        "overlist": "AC,HM",
        "maplist": "OSMC,EsriC,OpTop",
        "mapname": "",
        "mapurl": "",
        "mapopt": "",
        "mapwms": false,
        "x": 960,
        "y": 260,
        "wires": []
    },
    {
        "id": "bc940bbd8afbab5b",
        "type": "link in",
        "z": "a434980c0d70073f",
        "name": "map commands",
        "links": [
            "ccea04533f04c5b6"
        ],
        "x": 905,
        "y": 400,
        "wires": [
            [
                "19e42b65ee2aa91e"
            ]
        ]
    },
    {
        "id": "d388b17fb291ff1b",
        "type": "function",
        "z": "a434980c0d70073f",
        "name": "mappable?",
        "func": "if(!msg.payload.lat || !msg.payload.lon){\n    return null;\n}\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 190,
        "y": 140,
        "wires": [
            [
                "03565d1e34e0f066"
            ]
        ]
    },
    {
        "id": "b54a18c9b35f8e47",
        "type": "switch",
        "z": "a434980c0d70073f",
        "name": "gate",
        "property": "gate",
        "propertyType": "global",
        "rules": [
            {
                "t": "true"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 210,
        "y": 60,
        "wires": [
            [
                "d388b17fb291ff1b"
            ]
        ]
    },
    {
        "id": "de1ae4030d39dba1",
        "type": "worldmap in",
        "z": "a434980c0d70073f",
        "name": "",
        "path": "/worldmap",
        "events": "connect,disconnect,point,draw,layer,bounds,files,other",
        "x": 120,
        "y": 320,
        "wires": [
            [
                "8acf7b689dd92894",
                "00d6443f011302b7"
            ]
        ]
    },
    {
        "id": "8acf7b689dd92894",
        "type": "link out",
        "z": "a434980c0d70073f",
        "name": "map events",
        "mode": "link",
        "links": [
            "871ab37f14081d6c"
        ],
        "x": 315,
        "y": 320,
        "wires": []
    },
    {
        "id": "576c95c48853412c",
        "type": "function",
        "z": "a434980c0d70073f",
        "name": "read sta ifno",
        "func": "msg.payload = global.get('station_info')||{};\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 250,
        "y": 560,
        "wires": [
            [
                "f7800a14d83ea623",
                "4bf3dd3861bb7d93"
            ]
        ]
    },
    {
        "id": "f927f6a83992dda2",
        "type": "function",
        "z": "a434980c0d70073f",
        "name": "store station info",
        "func": "global.set('station_info',msg.payload);\nreturn null;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "// Code added here will be run once\n// whenever the node is started.\nglobal.set('station', [39,-83]);",
        "finalize": "",
        "libs": [],
        "x": 260,
        "y": 480,
        "wires": [
            []
        ]
    },
    {
        "id": "f7800a14d83ea623",
        "type": "change",
        "z": "a434980c0d70073f",
        "name": "station marker",
        "rules": [
            {
                "t": "set",
                "p": "payload.layer",
                "pt": "msg",
                "to": "station",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "payload.icon",
                "pt": "msg",
                "to": "bolt",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "payload.name",
                "pt": "msg",
                "to": "station",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "payload.label",
                "pt": "msg",
                "to": "Station",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "payload.ttl",
                "pt": "msg",
                "to": "360000",
                "tot": "num"
            },
            {
                "t": "set",
                "p": "payload.command",
                "pt": "msg",
                "to": "{\t   \"lat\":payload.lat,\t   \"lon\":payload.lon,\t   \"zoom\":8         \t}",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 440,
        "y": 540,
        "wires": [
            [
                "19e42b65ee2aa91e"
            ]
        ]
    },
    {
        "id": "4bf3dd3861bb7d93",
        "type": "function",
        "z": "a434980c0d70073f",
        "name": "range rings",
        "func": "const msgs = [];\nconst m_per_nm = 18520;\nfor (let i = 1; i <= 20; i++) {\n    msgs.push({\n        payload: {\n            name: `RR_${i}`,\n            radius: i * m_per_nm,\n            layer: 'station',\n            lat: msg.payload.lat,\n            lon: msg.payload.lon,\n            fill: false,\n            weight: i%5==0?0.5:0.1\n        }\n    })\n}\n\nreturn [msgs];",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 450,
        "y": 580,
        "wires": [
            [
                "19e42b65ee2aa91e"
            ]
        ]
    },
    {
        "id": "0475633569aff1cb",
        "type": "link in",
        "z": "a434980c0d70073f",
        "name": "link in 10",
        "links": [
            "805de6d09119fce1"
        ],
        "x": 95,
        "y": 480,
        "wires": [
            [
                "f927f6a83992dda2"
            ]
        ]
    },
    {
        "id": "00d6443f011302b7",
        "type": "switch",
        "z": "a434980c0d70073f",
        "name": "",
        "property": "payload.action",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "connected",
                "vt": "str"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "false",
        "repair": false,
        "outputs": 2,
        "x": 330,
        "y": 380,
        "wires": [
            [
                "576c95c48853412c",
                "f3cf3a3ccc351826"
            ],
            []
        ]
    },
    {
        "id": "f3cf3a3ccc351826",
        "type": "function",
        "z": "a434980c0d70073f",
        "name": "add buttons",
        "func": "msg.payload = {\n    \"command\": {\n        \"button\":[{\n            \"action\": \"button\",\n            \"name\": \"home\",\n            \"icon\": \"fa-home\"\n        }, {\n            \"action\": \"button\",\n            \"name\": \"pause\",\n            \"icon\": \"fa-pause\"\n        }]\n    }\n}\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 510,
        "y": 280,
        "wires": [
            [
                "19e42b65ee2aa91e"
            ]
        ]
    },
    {
        "id": "7e34ee95dc8e0367",
        "type": "function",
        "z": "9484dc2f12c3f5c6",
        "name": "close gate",
        "func": "global.set('gate', false)\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "// Code added here will be run once\n// whenever the node is started.\nglobal.set('gate', true)\n",
        "finalize": "",
        "libs": [],
        "x": 470,
        "y": 200,
        "wires": [
            [
                "ed396439b33bd82d",
                "a41a3563887cee67"
            ]
        ]
    },
    {
        "id": "ccea04533f04c5b6",
        "type": "link out",
        "z": "9484dc2f12c3f5c6",
        "name": "commands",
        "mode": "link",
        "links": [
            "bc940bbd8afbab5b"
        ],
        "x": 1075,
        "y": 340,
        "wires": []
    },
    {
        "id": "68e4d4b8bb64952d",
        "type": "function",
        "z": "9484dc2f12c3f5c6",
        "name": "remove btn",
        "func": "msg.payload = {\n    command: {\n        button:\n            { name: msg.payload }\n    }\n};\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 890,
        "y": 280,
        "wires": [
            [
                "ccea04533f04c5b6"
            ]
        ]
    },
    {
        "id": "c2a33697b3672983",
        "type": "function",
        "z": "9484dc2f12c3f5c6",
        "name": "add btn",
        "func": "msg.payload = {\n    command: {\n        button:\n            { action: 'button', icon: msg.icon, name: msg.payload }\n    }\n};\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 900,
        "y": 160,
        "wires": [
            [
                "ccea04533f04c5b6"
            ]
        ]
    },
    {
        "id": "871ab37f14081d6c",
        "type": "link in",
        "z": "9484dc2f12c3f5c6",
        "name": "link in 11",
        "links": [
            "8acf7b689dd92894"
        ],
        "x": 65,
        "y": 200,
        "wires": [
            [
                "bf8688a339f816d6"
            ]
        ]
    },
    {
        "id": "6beafc5d3a58f291",
        "type": "switch",
        "z": "9484dc2f12c3f5c6",
        "name": "button cmd",
        "property": "payload.name",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "pause",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "play",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "home",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 3,
        "x": 290,
        "y": 300,
        "wires": [
            [
                "7e34ee95dc8e0367"
            ],
            [
                "404bfabdd8a730dd"
            ],
            [
                "aebb3a98dbb3438c"
            ]
        ]
    },
    {
        "id": "bf8688a339f816d6",
        "type": "switch",
        "z": "9484dc2f12c3f5c6",
        "name": "event type",
        "property": "payload.action",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "button",
                "vt": "str"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 190,
        "y": 200,
        "wires": [
            [
                "6beafc5d3a58f291"
            ],
            []
        ]
    },
    {
        "id": "aebb3a98dbb3438c",
        "type": "function",
        "z": "9484dc2f12c3f5c6",
        "name": "set home",
        "func": "const sta = global.get('station_info');\nmsg.payload = {\n    command:{\n        lat:sta.lat,\n        lon:sta.lon\n    }\n}\n\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 660,
        "y": 400,
        "wires": [
            [
                "ccea04533f04c5b6"
            ]
        ]
    },
    {
        "id": "404bfabdd8a730dd",
        "type": "function",
        "z": "9484dc2f12c3f5c6",
        "name": "open gate",
        "func": "global.set('gate', true)\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "// Code added here will be run once\n// whenever the node is started.\nglobal.set('gate', true)\n",
        "finalize": "",
        "libs": [],
        "x": 480,
        "y": 300,
        "wires": [
            [
                "3179e6777df5fe1d",
                "94c216a970a26ad9"
            ]
        ]
    },
    {
        "id": "ed396439b33bd82d",
        "type": "change",
        "z": "9484dc2f12c3f5c6",
        "name": "rm pause",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "pause",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 660,
        "y": 240,
        "wires": [
            [
                "68e4d4b8bb64952d"
            ]
        ]
    },
    {
        "id": "a41a3563887cee67",
        "type": "change",
        "z": "9484dc2f12c3f5c6",
        "name": "add play",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "play",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "icon",
                "pt": "msg",
                "to": "fa-play",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 660,
        "y": 200,
        "wires": [
            [
                "c2a33697b3672983"
            ]
        ]
    },
    {
        "id": "3179e6777df5fe1d",
        "type": "change",
        "z": "9484dc2f12c3f5c6",
        "name": "rm play",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "play",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 660,
        "y": 300,
        "wires": [
            [
                "68e4d4b8bb64952d"
            ]
        ]
    },
    {
        "id": "94c216a970a26ad9",
        "type": "change",
        "z": "9484dc2f12c3f5c6",
        "name": "add pause",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "pause",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "icon",
                "pt": "msg",
                "to": "fa-pause",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 650,
        "y": 340,
        "wires": [
            [
                "c2a33697b3672983"
            ]
        ]
    },
    {
        "id": "a7ace214529cc712",
        "type": "ui_table",
        "z": "eeaa68697bf28d0e",
        "group": "350b84a00a67874f",
        "name": "Aircraft Info",
        "order": 1,
        "width": 8,
        "height": 6,
        "columns": [
            {
                "field": "hex",
                "title": "ICAO",
                "width": "",
                "align": "left",
                "formatter": "plaintext",
                "formatterParams": {
                    "target": "_blank"
                }
            },
            {
                "field": "flight",
                "title": "Flight",
                "width": "",
                "align": "left",
                "formatter": "plaintext",
                "formatterParams": {
                    "target": "_blank"
                }
            },
            {
                "field": "alt_baro",
                "title": "Alt",
                "width": "",
                "align": "left",
                "formatter": "plaintext",
                "formatterParams": {
                    "target": "_blank"
                }
            },
            {
                "field": "track",
                "title": "Track",
                "width": "",
                "align": "left",
                "formatter": "plaintext",
                "formatterParams": {
                    "target": "_blank"
                }
            },
            {
                "field": "gs",
                "title": "Speed",
                "width": "",
                "align": "left",
                "formatter": "plaintext",
                "formatterParams": {
                    "target": "_blank"
                }
            }
        ],
        "outputs": 1,
        "cts": true,
        "x": 890,
        "y": 80,
        "wires": [
            [
                "ac14fbfe9a152586",
                "e28964d4782e8217",
                "b9cb0a1cdd3f4461",
                "fd5e3a141c325093",
                "0151e9ab920d1bd1",
                "689ba6b091c177da",
                "074a4ccc56f2dacd",
                "094a915d2e8ecc27",
                "34cc59fd649a7191",
                "6d30a9103e1e4ff4",
                "07105d583fe42a36",
                "499dc708fa5b15c6"
            ]
        ]
    },
    {
        "id": "1f9a326e881f765b",
        "type": "link in",
        "z": "eeaa68697bf28d0e",
        "name": "link in 6",
        "links": [
            "6ec40af1917d9ff4"
        ],
        "x": 625,
        "y": 80,
        "wires": [
            [
                "a7ace214529cc712"
            ]
        ]
    },
    {
        "id": "ac14fbfe9a152586",
        "type": "ui_text",
        "z": "eeaa68697bf28d0e",
        "group": "2a53099271750475",
        "order": 1,
        "width": 4,
        "height": 1,
        "name": "",
        "label": "ICAO",
        "format": "{{msg.payload.hex}}",
        "layout": "row-spread",
        "className": "",
        "style": false,
        "font": "",
        "fontSize": 16,
        "color": "#000000",
        "x": 1210,
        "y": 80,
        "wires": []
    },
    {
        "id": "e28964d4782e8217",
        "type": "ui_text",
        "z": "eeaa68697bf28d0e",
        "group": "2a53099271750475",
        "order": 2,
        "width": 4,
        "height": 1,
        "name": "",
        "label": "Flight",
        "format": "{{msg.payload.flight}}",
        "layout": "row-spread",
        "className": "",
        "style": false,
        "font": "",
        "fontSize": 16,
        "color": "#000000",
        "x": 1210,
        "y": 120,
        "wires": []
    },
    {
        "id": "b9cb0a1cdd3f4461",
        "type": "ui_text",
        "z": "eeaa68697bf28d0e",
        "group": "2a53099271750475",
        "order": 3,
        "width": 4,
        "height": 1,
        "name": "",
        "label": "Squawk",
        "format": "{{msg.payload.squawk}}",
        "layout": "row-spread",
        "className": "",
        "style": false,
        "font": "",
        "fontSize": 16,
        "color": "#000000",
        "x": 1220,
        "y": 160,
        "wires": []
    },
    {
        "id": "fd5e3a141c325093",
        "type": "ui_text",
        "z": "eeaa68697bf28d0e",
        "group": "2a53099271750475",
        "order": 5,
        "width": 4,
        "height": 1,
        "name": "",
        "label": "Alt (baro)",
        "format": "{{msg.payload.alt_baro}} ft",
        "layout": "row-spread",
        "className": "",
        "style": false,
        "font": "",
        "fontSize": 16,
        "color": "#000000",
        "x": 1220,
        "y": 200,
        "wires": []
    },
    {
        "id": "0151e9ab920d1bd1",
        "type": "ui_text",
        "z": "eeaa68697bf28d0e",
        "group": "2a53099271750475",
        "order": 6,
        "width": 4,
        "height": 1,
        "name": "",
        "label": "Alt (geo)",
        "format": "{{msg.payload.alt_geom}} ft",
        "layout": "row-spread",
        "className": "",
        "style": false,
        "font": "",
        "fontSize": 16,
        "color": "#000000",
        "x": 1220,
        "y": 240,
        "wires": []
    },
    {
        "id": "689ba6b091c177da",
        "type": "ui_text",
        "z": "eeaa68697bf28d0e",
        "group": "2a53099271750475",
        "order": 7,
        "width": 4,
        "height": 1,
        "name": "",
        "label": "Heading (nav)",
        "format": "{{msg.payload.nav_heading}} &deg;",
        "layout": "row-spread",
        "className": "",
        "style": false,
        "font": "",
        "fontSize": 16,
        "color": "#000000",
        "x": 1240,
        "y": 320,
        "wires": []
    },
    {
        "id": "074a4ccc56f2dacd",
        "type": "ui_text",
        "z": "eeaa68697bf28d0e",
        "group": "2a53099271750475",
        "order": 8,
        "width": 4,
        "height": 1,
        "name": "",
        "label": "Track",
        "format": "{{msg.payload.track}} &deg;",
        "layout": "row-spread",
        "className": "",
        "style": false,
        "font": "",
        "fontSize": 16,
        "color": "#000000",
        "x": 1210,
        "y": 360,
        "wires": []
    },
    {
        "id": "094a915d2e8ecc27",
        "type": "ui_text",
        "z": "eeaa68697bf28d0e",
        "group": "2a53099271750475",
        "order": 9,
        "width": 4,
        "height": 1,
        "name": "",
        "label": "Speed (gnd)",
        "format": "{{msg.payload.gs}} kt",
        "layout": "row-spread",
        "className": "",
        "style": false,
        "font": "",
        "fontSize": 16,
        "color": "#000000",
        "x": 1230,
        "y": 400,
        "wires": []
    },
    {
        "id": "34cc59fd649a7191",
        "type": "ui_text",
        "z": "eeaa68697bf28d0e",
        "group": "2a53099271750475",
        "order": 4,
        "width": 4,
        "height": 1,
        "name": "",
        "label": "Signal",
        "format": "{{msg.payload.rssi}} dbFS",
        "layout": "row-spread",
        "className": "",
        "style": false,
        "font": "",
        "fontSize": 16,
        "color": "#000000",
        "x": 1210,
        "y": 480,
        "wires": []
    },
    {
        "id": "cd9e87c74de263fe",
        "type": "ui_text",
        "z": "eeaa68697bf28d0e",
        "group": "2a53099271750475",
        "order": 12,
        "width": 4,
        "height": 1,
        "name": "",
        "label": "Last Seen",
        "format": "{{msg.payload}} sec",
        "layout": "row-spread",
        "className": "",
        "style": false,
        "font": "",
        "fontSize": 16,
        "color": "#000000",
        "x": 1220,
        "y": 520,
        "wires": []
    },
    {
        "id": "beebb160cf9b6f36",
        "type": "link in",
        "z": "eeaa68697bf28d0e",
        "name": "link in 7",
        "links": [
            "805de6d09119fce1"
        ],
        "x": 185,
        "y": 80,
        "wires": [
            [
                "11562c59e67ced59",
                "09453a8c7cd75455",
                "2ce6b92d1e037a8a"
            ]
        ]
    },
    {
        "id": "87ae45c3d541df2a",
        "type": "link in",
        "z": "eeaa68697bf28d0e",
        "name": "link in 8",
        "links": [
            "3aa8cd7ef5bedf96"
        ],
        "x": 195,
        "y": 280,
        "wires": [
            [
                "a9e5bed8dffcd5ca",
                "052821370bf7a1f1",
                "737cbf8b6b504f96",
                "267b5709df750d49",
                "0926e908e6084683"
            ]
        ]
    },
    {
        "id": "11562c59e67ced59",
        "type": "ui_text",
        "z": "eeaa68697bf28d0e",
        "group": "5d571e7886c72a5e",
        "order": 1,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Version",
        "format": "{{msg.payload.version}}",
        "layout": "row-spread",
        "className": "",
        "style": false,
        "font": "",
        "fontSize": 16,
        "color": "#000000",
        "x": 340,
        "y": 80,
        "wires": []
    },
    {
        "id": "09453a8c7cd75455",
        "type": "ui_text",
        "z": "eeaa68697bf28d0e",
        "group": "5d571e7886c72a5e",
        "order": 2,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Geo",
        "format": "{{msg.payload.lat}}, {{msg.payload.lon}}",
        "layout": "row-spread",
        "className": "",
        "style": false,
        "font": "",
        "fontSize": 16,
        "color": "#000000",
        "x": 330,
        "y": 160,
        "wires": []
    },
    {
        "id": "2ce6b92d1e037a8a",
        "type": "ui_text",
        "z": "eeaa68697bf28d0e",
        "group": "5d571e7886c72a5e",
        "order": 3,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Refresh Rate",
        "format": "{{msg.payload.refresh/1000}} / sec",
        "layout": "row-spread",
        "className": "",
        "style": false,
        "font": "",
        "fontSize": 16,
        "color": "#000000",
        "x": 360,
        "y": 120,
        "wires": []
    },
    {
        "id": "6d30a9103e1e4ff4",
        "type": "ui_text",
        "z": "eeaa68697bf28d0e",
        "group": "2a53099271750475",
        "order": 11,
        "width": 4,
        "height": 1,
        "name": "",
        "label": "Vert Rate (baro)",
        "format": "{{msg.payload.baro_rate}} ft/min",
        "layout": "row-spread",
        "className": "",
        "style": false,
        "font": "",
        "fontSize": 16,
        "color": "#000000",
        "x": 1240,
        "y": 280,
        "wires": []
    },
    {
        "id": "07105d583fe42a36",
        "type": "change",
        "z": "eeaa68697bf28d0e",
        "name": "last seen",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "$min([payload.seen, payload.seen_pos])\t",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1060,
        "y": 520,
        "wires": [
            [
                "cd9e87c74de263fe"
            ]
        ]
    },
    {
        "id": "634713a7cd70f4b1",
        "type": "ui_table",
        "z": "eeaa68697bf28d0e",
        "group": "5d571e7886c72a5e",
        "name": "By Min",
        "order": 7,
        "width": 6,
        "height": 2,
        "columns": [
            {
                "field": "metric",
                "title": "Metric",
                "width": "",
                "align": "left",
                "formatter": "plaintext",
                "formatterParams": {
                    "target": "_blank"
                }
            },
            {
                "field": "last1min",
                "title": "1 Min",
                "width": "",
                "align": "left",
                "formatter": "plaintext",
                "formatterParams": {
                    "target": "_blank"
                }
            },
            {
                "field": "last5min",
                "title": "5 Min",
                "width": "",
                "align": "left",
                "formatter": "plaintext",
                "formatterParams": {
                    "target": "_blank"
                }
            },
            {
                "field": "last15min",
                "title": "15 Min",
                "width": "",
                "align": "left",
                "formatter": "plaintext",
                "formatterParams": {
                    "target": "_blank"
                }
            }
        ],
        "outputs": 0,
        "cts": false,
        "x": 470,
        "y": 420,
        "wires": []
    },
    {
        "id": "499dc708fa5b15c6",
        "type": "ui_text",
        "z": "eeaa68697bf28d0e",
        "group": "2a53099271750475",
        "order": 10,
        "width": 4,
        "height": 1,
        "name": "",
        "label": "Speed (air)",
        "format": "{{msg.payload.ias}} kt",
        "layout": "row-spread",
        "className": "",
        "style": false,
        "font": "",
        "fontSize": 16,
        "color": "#000000",
        "x": 1230,
        "y": 440,
        "wires": []
    },
    {
        "id": "a9e5bed8dffcd5ca",
        "type": "ui_text",
        "z": "eeaa68697bf28d0e",
        "group": "5d571e7886c72a5e",
        "order": 4,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Gain",
        "format": "{{msg.payload.total.local.gain_db}} dB",
        "layout": "row-spread",
        "className": "",
        "style": false,
        "font": "",
        "fontSize": 16,
        "color": "#000000",
        "x": 470,
        "y": 280,
        "wires": []
    },
    {
        "id": "052821370bf7a1f1",
        "type": "ui_text",
        "z": "eeaa68697bf28d0e",
        "group": "5d571e7886c72a5e",
        "order": 5,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "> -3 dBFS",
        "format": "{{msg.payload.total.local.strong_signals}}",
        "layout": "row-spread",
        "className": "",
        "style": false,
        "font": "",
        "fontSize": 16,
        "color": "#000000",
        "x": 490,
        "y": 320,
        "wires": []
    },
    {
        "id": "737cbf8b6b504f96",
        "type": "ui_text",
        "z": "eeaa68697bf28d0e",
        "group": "5d571e7886c72a5e",
        "order": 6,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Peak Signal",
        "format": "{{msg.payload.total.local.peak_signal}} dBFS",
        "layout": "row-spread",
        "className": "",
        "style": false,
        "font": "",
        "fontSize": 16,
        "color": "#000000",
        "x": 490,
        "y": 360,
        "wires": []
    },
    {
        "id": "267b5709df750d49",
        "type": "function",
        "z": "eeaa68697bf28d0e",
        "name": "1/5/15 Min",
        "func": "const periods = ['last1min','last5min','last15min'];\nconst metrics = ['accepted','rejected','peak_signal'];\nconst msgs = [];\n\n// sum the accepted\nfor (let period of periods) {\n    msg.payload[period].local.accepted = msg.payload[period].local.accepted.reduce((a,b)=>a+b,0);\n    msg.payload[period].local.rejected = msg.payload[period].local.bad;\n}\n\nfor(let metric of metrics){\n    msgs.push( {\n        topic:metric,\n        payload:{\n            metric,\n            last1min: msg.payload.last1min.local[metric],\n            last5min: msg.payload.last5min.local[metric],\n            last15min: msg.payload.last15min.local[metric],\n        }\n    });\n}\n\nmsgs[msgs.length-1].complete = true;\nreturn [msgs];",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 190,
        "y": 420,
        "wires": [
            [
                "39b4ca1e2c0e181e"
            ]
        ]
    },
    {
        "id": "39b4ca1e2c0e181e",
        "type": "join",
        "z": "eeaa68697bf28d0e",
        "name": "",
        "mode": "custom",
        "build": "array",
        "property": "payload",
        "propertyType": "msg",
        "key": "topic",
        "joiner": "\\n",
        "joinerType": "str",
        "accumulate": false,
        "timeout": "",
        "count": "",
        "reduceRight": false,
        "reduceExp": "",
        "reduceInit": "",
        "reduceInitType": "",
        "reduceFixup": "",
        "x": 350,
        "y": 420,
        "wires": [
            [
                "634713a7cd70f4b1"
            ]
        ]
    },
    {
        "id": "0926e908e6084683",
        "type": "function",
        "z": "eeaa68697bf28d0e",
        "name": "lastest signal",
        "func": "const msgs = [];\nmsgs.push({\n    topic: 'signal',\n    payload: msg.payload.last1min.local.signal\n});\nmsgs.push({\n    topic: 'noise',\n    payload: msg.payload.last1min.local.noise\n});\n\nreturn [msgs];",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 190,
        "y": 500,
        "wires": [
            [
                "39d1c07212f906ea"
            ]
        ]
    },
    {
        "id": "39d1c07212f906ea",
        "type": "ui_chart",
        "z": "eeaa68697bf28d0e",
        "name": "",
        "group": "5d571e7886c72a5e",
        "order": 8,
        "width": 0,
        "height": 0,
        "label": "dBFS",
        "chartType": "line",
        "legend": "true",
        "xformat": "HH:mm",
        "interpolate": "linear",
        "nodata": "",
        "dot": false,
        "ymin": "",
        "ymax": "",
        "removeOlder": "15",
        "removeOlderPoints": "",
        "removeOlderUnit": "60",
        "cutout": 0,
        "useOneColor": false,
        "useUTC": false,
        "colors": [
            "#1f77b4",
            "#aec7e8",
            "#ff7f0e",
            "#2ca02c",
            "#98df8a",
            "#d62728",
            "#ff9896",
            "#9467bd",
            "#c5b0d5"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "className": "",
        "x": 470,
        "y": 500,
        "wires": [
            []
        ]
    }
]